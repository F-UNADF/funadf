.breadcrumbs
  .page-header
    %h1 Gestion des utilisateurs


.content.mt-3
  .container-fluid
    .card
      .card-header
        %strong Liste des utilisateurs
        .card-actions

          = link_to new_user_invitation_path, class: "btn-setting" do
            = icon 'plus'
            Ajouter

          = link_to admin_import_path(:get_file), class: "btn-setting" do
            = icon "upload"
            Importer depuis un fichier

      .card-body
        = search_form_for [:admin, @q] do |f|
          .row
            .col-md-4
              .form-group
                = f.label :firstname_or_lastname_cont
                = f.text_field :firstname_or_lastname_cont, class: "form-control"
            .col-md-4
              .form-group
                = f.label :level_eq
                = f.select :level_eq, options_for_select(User.get_levels, @q.level_eq), {include_blank: " Tous "}, class: "form-control"
            .col-md-4
              %button.btn.btn-success.mt-4{type: :submit}
                = icon "search"
                Rechercher



        .table-responsive
          %table.table.table-striped.table-sm
            %thead
              %tr
                %th= sort_link(@q, :id, 'Identifiant', default_order: :asc)
                %th= sort_link(@q, :firstname, 'Nom')
                %th Email
                %th Téléphone
                %th= sort_link(@q, :level, 'Reconnaissance')
                %th

            - @users.each do |user|
              %tr
                %td= user.friendly_id
                %td
                  = link_to user, class: "text-info" do
                    = user.fullname
                    = icon "eye"
                %td= user.email
                %td= user.phone_1
                %td= user.level
                %td
                  - if user.id == current_user.id
                    %em C'est vous !
                  - else
                    %ul.list-inline.mb-0
                      - if can? :edit, user
                        %li.list-inline-item
                          = link_to [:edit, :admin, user], class: "text-success" do
                            = icon "edit"
                            Modifier
                      - if can? :delete, user
                        %li.list-inline-item
                          = link_to [:admin, user], method: :delete, data:{confirm: 'Êtes vous sûr ?'}, class: "text-danger" do
                            = icon "times"
                            Supprimer

        .float-right
          = will_paginate @users