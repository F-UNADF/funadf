.breadcrumbs
  .page-header
    %h1 Gestion des campagnes

.content.mt-3
  .container-fluid
    .card
      .card-header
        %strong Liste des campagnes
        .card-actions
          = link_to new_admin_campaign_path, class: "btn-setting" do
            = icon 'fa', 'plus'
            Ajouter

      .card-body
        = search_form_for [:admin, @q] do |f|
          .row
            .col-md-4
              .form-group
                = f.label :name_cont
                = f.text_field :name_cont, class: "form-control"

            .col-md-4
              .form-group
                = f.label :state_eq
                = f.select :state_eq, options_for_select(state_for_select), {include_blank: 'Toutes les campagnes'}, class: "form-control"

            .col-md-4
              %button.btn.btn-success.mt-4{type: :submit}
                = icon 'fa', "search"
                Rechercher



        .table-responsive
          %table.table.table-striped.table-sm
            %thead
              %tr
                %th Structure
                %th

            - @campaigns.each do |campaign|
              %tr
                %td
                  = campaign.structure_name
                  %span.badge.badge-pill.ml-3{class: "badge-#{campaign.state_class}"}= I18n.t "activerecord.attributes.campaign.states.#{campaign.state}"
                  %br
                  %small
                    %em= campaign.name

                %td
                  .btn-group
                    = link_to [:admin, campaign], class: "btn btn-sm btn-info" do
                      = icon 'fa', "eye"

                    = link_to [:edit, :admin, campaign], class: "btn btn-sm btn-primary" do
                      = icon 'fa', "edit"

                    = link_to [:admin, campaign], method: :delete, data:{confirm: 'Êtes vous sûr ?'}, class: "btn btn-sm btn-danger" do
                      = icon 'fa', "times"

                    - if campaign.can_close_temporarily?
                      = link_to [:admin, campaign, :close_temporarily], class: "btn btn-sm btn-link text-info" do
                        = icon 'fa', "times-circle"
                        Fermer la campagne*

                    - if campaign.can_opening?
                      = link_to [:admin, campaign, :open], class: "btn btn-sm btn-link text-success" do
                        = icon 'fa', "check-circle"
                        Ouvrir la campagne*

                    - if campaign.can_close_definitly?
                      = link_to [:admin, campaign, :close_definitly], data:{confirm: 'Êtes vous sûr, cette action est irreversible ?'}, class: "btn btn-sm btn-link text-warning" do
                        = icon 'fa', "times-circle"
                        Cloturer la campagne*

        %p
          %b.text-info
            = icon 'fa', "times-circle"
            Fermer la campagne :
          Ferme la campagne, rend les votes impossibles, mais permet une réouverture (les votes ne sont pas réinitialisés)
          %br
          %b.text-success
            = icon 'fa', "check-circle"
            Ouvrir la campagne :
          Ouvre la campagne de vote
          %br
          %b.text-black
            = icon 'fa', "times-circle"
            Cloturer la campagne :
          Cloture la camapane, ferme les votes, ne permet pas la réouverture

        = will_paginate @campaigns
